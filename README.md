# Maltrail <= v0.54 RCE Exploit PoC
Simple Proof-of-Concept script to exploit RCE vulnerability in Maltrail &lt;= v0.54

## How it works 
The `username` parameter in the Maltrail login page is vulnerable to remote code execution as it is nested inside a [`subprocess.check_output` function](https://docs.python.org/3.8/library/subprocess.html#subprocess.check_output). As specified in documentation, this function is equivalent to [`subprocess.run()`](https://docs.python.org/3.8/library/subprocess.html#subprocess.run); simply injecting the command and backticks to perform command substitution will suffice to ensure our injected command works.  

My implementation works off an example of the [Metasploit module](https://packetstormsecurity.com/files/174221/Maltrail-0.53-Unauthenticated-Command-Injection.html), allows to set the target from the command line, and specify what command to run (make sure to enclose it in single quotes `'`) which will be encoded to base64 in an effort to simplify testing and exploiting.  

All credit on the vulnerability goes to [Chris Wild, who disclosed it with huntr](https://huntr.com/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/)

## Disclaimer
This PoC is intended for educational and legal use only.  
Never perform penetration testing and vulnerability exploitation actions without proper permission and authorization.

## References
- https://packetstormsecurity.com/files/174221/Maltrail-0.53-Unauthenticated-Command-Injection.html
- https://huntr.com/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/
